{% extends 'base.html.twig' %}

{% block stylesheets %}
    <style>
        table {
            border-collapse: collapse;
            margin: 0 auto;
            font-family: Arial, sans-serif;
        }

        table th, table td {
            border: 1px solid black;
            padding: 30px;
        }

        table th {
            background-color: #00d1b2;
            color: white;
        }
/*page fond noir*/
        #add-competiteur-form {
            display: none;
            margin: 0 auto;
            max-width: 10000px;
            padding: 100px;
            border: 1px solid black;
            background-color: rgba(0, 0, 0, 0.7);
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            z-index: 999;
        }

        #add-competiteur-form.open {
            display: block;
        }

        #add-competiteur-form label {
            color: white;
            font-size: 18px;
        }

        #add-competiteur-form input[type=text] {
            border: none;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            width: 100%;
            font-size: 16px;
            background-color: #f5f5f5;
        }

        #add-competiteur-form button[type=submit] {
            background-color: #00d1b2;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 16px;
            padding: 10px 20px;
            margin-top: 10px;
        }
/*bouton add compétiteur*/
        #add-competiteur-button {
            background-color: black;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        .button-container {
            display: flex;
            justify-content: center;
            margin: 20px;
        }

        .fa-pencil-alt {
            color: black;
        }

        .fa-trash {
            color: red;
            cursor: pointer;
        }

    </style>
{% endblock %}

{% block body %}
    <section class="hero is-light is-half-mobile">
        <div class="hero-body">
            <div class="container has-text-centered">
                <h1 class="title">
                    Liste des compétiteurs
                </h1>
            </div>
        </div>
    </section>
    <div class="button-container">
        <button id="add-competiteur-button">Ajouter compétiteur</button>
    </div>

    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Nom</th>
            <th>Prénom</th>
            <th>Niveau</th>
            <th>Numéro de licence</th>
            <th>Notes</th>
            <th>Compétition</th>
        </tr>
        </thead>
        <tbody>
        {% for competiteur in competiteurs %}
            <tr>
                <td>{{ competiteur.id_competiteur }}</td>
                <td>{{ competiteur.nom_competiteur }}</td>
                <td>{{ competiteur.prenom_competiteur }}</td>
                <td>{{ competiteur.niveau_compet }}</td>
                <td>{{ competiteur.num_licence }}</td>
                <td>{{ competiteur.notes_competiteur }}</td>
                <td>{{ competiteur.nom_competition }}</td>
                <td>
                    <a href="#"class="fas fa-pencil-alt" onclick="return confirm('Êtes-vous sûr de vouloir modifier ce compétiteur ?')"></a>
                </td>
                <td>
                    <span class="icon has-text-danger suppr-competiteur" data-target="#deleteModal-{{ competiteur.id_competiteur }}"><i class="fas fa-trash-alt"></i></span>
                    <div id="deleteModal-{{ competiteur.id_competiteur }}" class="modal">
                        <div class="modal-background"></div>
                        <div class="modal-card">
                            <header class="modal-card-head">
                                <p class="modal-card-title">Supprimer le compétiteur</p>
                                <button class="delete" aria-label="close"></button>
                            </header>
                            <section class="modal-card-body has-text-centered">
                                <p>Êtes-vous sûr de vouloir supprimer ce compétiteur ?</p>
                                <br>
                                <form method="POST" action="{{ path('competiteur_delete', {'id': competiteur.id_competiteur }) }}">
                                    <input type="hidden" name="_method">
                                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ competiteur.id_competiteur) }}">
                                    <button class="button is-danger">Supprimer</button>
                                    <button class="button">Annuler</button>
                                </form>
                            </section>
                        </div>
                    </div>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <form id="add-competiteur-form" method="post">
        <div>
            <label for="nom-competiteur">Nom :</label>
            <input type="text" id="nom-competiteur" name="nomCompetiteur" required>
        </div>
        <div>
            <label for="prenom-competiteur">Prénom :</label>
            <input type="text" id="prenom-competiteur" name="prenomCompetiteur" required>
        </div>
        <div>
            <label for="niveau-compet">Niveau :</label>
            <input type="text" id="niveau-compet" name="niveauCompet" required>
        </div>
        <div>
            <label for="num-licence">Numéro de licence :</label>
            <input type="text" id="num-licence" name="numLicence" required>
        </div>
        <div>
            <label for="notes-competiteur">Notes :</label>
            <input type="text" id="notes-competiteur" name="notesCompetiteur">
        </div>
        <div>
            <label for="nom-competition">Nom compétition :</label>
            <input type="text" id="nom-competiton" name="nomCompetition">
        </div>
        <button type="submit">Ajouter</button>
    </form>
{% endblock %}

{% block javascripts %}
    <script>
        // On récupère le bouton qui show le formulaire ainsi que le formulaire en personne

        const addButton = document.getElementById('add-competiteur-button');
        const addForm = document.getElementById('add-competiteur-form');
        // Evenement sur clic du bouton ajouter
        addButton.addEventListener('click', () => {
            // Clic affichage formulaire
            addForm.style.display = 'block';
        });

        function closeForm() {
            document.getElementById("popupForm").classList.remove("is-active");
        }
        var deleteModals = document.querySelectorAll('.suppr-competiteur');
        deleteModals.forEach(function(deleteModal) {
            deleteModal.addEventListener('click', function() {
                var target = document.querySelector(deleteModal.getAttribute('data-target'));
                target.classList.add('is-active');
                target.querySelector('.delete').addEventListener('click', function() {
                    target.classList.remove('is-active');
                });
            });
        });
    </script>

{% endblock %}



